---
title: "Plot all genes omega histogram"
output: html_document
date: "2024-12-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document.

```{r}
library(tidyverse)
library(cowplot)
```

```{r}
all_omega = read.table("G:/My Drive/Circadian Rhythm Genes Project/21.Omega_value_results/4.All_gene_omega/omega_all.csv", header = T, sep = ",")

z_omega_values = read.table("G:/My Drive/Circadian Rhythm Genes Project/35.Busco_all_genes/9.Z-linked/omega_values.csv", header = T, sep = ",")

Period <- subset(all_omega, Gene == "period")$Omega
#g8751at7088 <- subset(all_omega, Gene == "8751at7088")$Omega
CHMP1B <- subset(all_omega, Gene == "12510at7088")$Omega
#ACAT1 <- subset(all_omega, Gene == "4043at7088")$Omega
PDCD6IP <- subset(all_omega, Gene == "5159at7088")$Omega
#CNGA2 <- subset(all_omega, Gene == "2331at7088")$Omega
#g5679at7088 <- subset(all_omega, Gene == "5679at7088")$Omega
#timeout <- subset(all_omega, Gene == "timeout")$Omega
percentile_95 <- quantile(all_omega$Omega, 0.95)

pdf("G:/My Drive/Circadian Rhythm Genes Project/21.Omega_value_results/4.All_gene_omega/omega_plot_rho_genes.pdf", height = 5, width = 7)
ggplot(data = all_omega,aes (x = Omega))+
  geom_density(aes(y = ..count..),fill = "darkgrey", color = "black")+
  geom_density(data = z_omega_values,aes (x = Omega,y = ..count..),fill = "black", color = "black",alpha = 0.8 )+
  
  
  geom_vline(xintercept = Period, color = "red", linetype = "dashed", size = 0.5)+
  annotate("text", x= Period, y = 25000, label = "Period",angle = -90, vjust = -0.5, color = "black",size = 3)+
  
 # geom_vline(xintercept = g8751at7088, color = "red", linetype = "dashed", size = 0.5)+
  #geom_text(x = g8751at7088, y = 25000, label = "8751at7088",angle = -90, vjust = -1.5, color = "black",size = 2)+
  
  
  geom_vline(xintercept = percentile_95, color = "red", linetype = "solid", size = 0.5)+
 annotate("text",x = percentile_95, y = 25000, label = "95th Percentile",angle = -90, vjust = 1.5, color = "black",size = 3)+
  
  
  geom_vline(xintercept = CHMP1B, color = "red", linetype = "dashed", size = 0.5)+
  annotate("text", x = CHMP1B, y = 30000, label = "CHMP1B", angle = -90, vjust = -0.5, color = "black", size = 3) +
  
  
  #geom_vline(xintercept = ACAT1, color = "red", linetype = "dashed", size = 0.5)+
  #geom_text(x = ACAT1, y = 27000, label = "ACAT1",angle = -90, vjust = 1.5, color = "black",size = 2)+
  
  
  geom_vline(xintercept = PDCD6IP, color = "red", linetype = "dashed", size = 0.5)+
  annotate("text",x = PDCD6IP, y = 25000, label = "PDCD6IP",angle = -90, vjust = -0.5, color = "black",size = 3)+
  
  
  #geom_vline(xintercept = CNGA2, color = "red", linetype = "dashed", size = 0.5)+
  #geom_text(x = CNGA2, y = 25000, label = "CNGA2",angle = -90, vjust = 1.5, color = "black",size = 2)+
  
  
  #geom_vline(xintercept = g5679at7088, color = "red", linetype = "dashed", size = 0.5)+
  #geom_text(x = g5679at7088, y = 25000, label = "5679at7088",angle = -90, vjust = 1.5, color = "black",size = 2)+
  
  
  #geom_vline(xintercept = timeout, color = "red", linetype = "dashed", size = 0.5)+
  #geom_text(x = timeout, y = 30000, label = "Timeout",angle = -90, vjust = 1.5, color = "black",size = 2)+
  coord_cartesian(xlim = c(0.0, 0.45)) +
  theme_cowplot(12)+
  theme(axis.ticks.y = element_blank(), axis.text.y = element_blank())
dev.off()
  

```

```{r}
percentile <- ecdf(all_omega$Omega)(Tim) * 100
percentile_95 <- quantile(all_omega$Omega, 0.95)
```
